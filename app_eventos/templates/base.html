{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}Eventix{% endblock %}</title>
  
  <!-- PWA Meta Tags -->
  <meta name="description" content="A plataforma definitiva para transformar eventos em experi√™ncias de sucesso. Conectando produtores e profissionais independentes em um s√≥ lugar.">
  <meta name="theme-color" content="#0d6efd">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Eventix">
  
  <!-- Manifest -->
  <link rel="manifest" href="/manifest.json">
  
  <!-- Icons -->
  <link rel="icon" type="image/png" href="{% static 'logo_eventix.png' %}">
  <link rel="apple-touch-icon" sizes="180x180" href="{% static 'icons/apple-touch-icon-180x180.png' %}">
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>
  <!-- Bot√£o Flutuante do Menu -->
  <button id="menuButton" class="menu-btn" aria-label="Abrir menu">
    <i class="fas fa-bars"></i>
  </button>

  <!-- Overlay Escuro -->
  <div id="menuOverlay" class="menu-overlay"></div>

  <!-- Menu Lateral -->
  <div id="sideMenu" class="side-menu">
    <div class="side-menu-header">
      <h3>üéüÔ∏è Eventix</h3>
      <button class="close-btn" aria-label="Fechar menu">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <ul class="side-menu-nav">
      <li>
        <a href="{% url 'home' %}" class="{% if request.resolver_match.url_name == 'home' %}active{% endif %}">
          <i class="fas fa-home"></i>
          <span>In√≠cio</span>
        </a>
      </li>
      <li>
        <a href="{% url 'freelancer_publico:vagas_disponiveis' %}" class="{% if 'vagas' in request.resolver_match.url_name %}active{% endif %}">
          <i class="fas fa-briefcase"></i>
          <span>Vagas</span>
        </a>
      </li>
      <li>
        <a href="{% url 'freelancer_publico:dashboard' %}" class="{% if 'freelancer' in request.resolver_match.url_name or 'freelancer' in request.path %}active{% endif %}">
          <i class="fas fa-motorcycle"></i>
          <span>Motoboys</span>
        </a>
      </li>
      <li>
        <a href="{% url 'dashboard_empresa:login_empresa' %}" class="{% if 'empresa' in request.path %}active{% endif %}">
          <i class="fas fa-building"></i>
          <span>Estabelecimentos</span>
        </a>
      </li>
      <li class="side-menu-divider"></li>
      <li>
        <a href="#" onclick="alert('Configura√ß√µes em desenvolvimento'); return false;">
          <i class="fas fa-cog"></i>
          <span>Configura√ß√µes</span>
        </a>
      </li>
      {% if user.is_authenticated %}
      <li>
        <a href="{% url 'freelancer_publico:logout' %}" class="text-danger">
          <i class="fas fa-sign-out-alt"></i>
          <span>Sair</span>
        </a>
      </li>
      {% else %}
      <li>
        <a href="{% url 'freelancer_publico:login' %}">
          <i class="fas fa-sign-in-alt"></i>
          <span>Entrar</span>
        </a>
      </li>
      {% endif %}
    </ul>
  </div>

  <header>
    <div class="container">
      <h1>üéüÔ∏è Eventix</h1>
      <p class="lead">Organiza√ß√£o √© o espet√°culo.</p>
    </div>
  </header>

  <main class="container">
    {% block content %}{% endblock %}
  </main>

  <footer>
    <p>¬© {{ now|date:"Y" }} Eventix ‚Äî Todos os direitos reservados</p>
  </footer>

  <!-- Service Worker Registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js')
          .then((registration) => {
            console.log('‚úÖ Service Worker registrado com sucesso:', registration.scope);
            
            // Verifica atualiza√ß√µes periodicamente
            setInterval(() => {
              registration.update();
            }, 60000); // A cada 1 minuto
          })
          .catch((error) => {
            console.log('‚ùå Falha ao registrar Service Worker:', error);
          });
      });
    }
  </script>

  <!-- Script do Menu Lateral -->
  <script>
    (function() {
      const menuButton = document.getElementById('menuButton');
      const sideMenu = document.getElementById('sideMenu');
      const menuOverlay = document.getElementById('menuOverlay');
      const closeButton = sideMenu.querySelector('.close-btn');
      
      function openMenu() {
        sideMenu.classList.add('open');
        menuOverlay.classList.add('active');
        document.body.style.overflow = 'hidden'; // Previne scroll no body
      }
      
      function closeMenu() {
        sideMenu.classList.remove('open');
        menuOverlay.classList.remove('active');
        document.body.style.overflow = ''; // Restaura scroll
      }
      
      // Abrir menu
      menuButton.addEventListener('click', openMenu);
      
      // Fechar menu
      closeButton.addEventListener('click', closeMenu);
      menuOverlay.addEventListener('click', closeMenu);
      
      // Fechar ao clicar em um link (opcional - pode remover se quiser que o menu permane√ßa aberto)
      const menuLinks = sideMenu.querySelectorAll('.side-menu-nav a');
      menuLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          // Se o link n√£o for "#" ou n√£o tiver onclick, fecha o menu
          if (!this.getAttribute('href') || this.getAttribute('href') !== '#') {
            // Pequeno delay para melhor UX
            setTimeout(closeMenu, 150);
          }
        });
      });
      
      // Fechar com ESC
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && sideMenu.classList.contains('open')) {
          closeMenu();
        }
      });
    })();
  </script>
</body>
</html>
